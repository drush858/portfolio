<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:replace="~{layout/main :: layout(
          ~{::content},
          'Accounts',
          ~{::head}
      )}">

<head>
    <title th:text="~{${pageTitle} ?: 'Portfolio Tracker'}">Portfolio Tracker</title>
</head>

<body>
<div th:fragment="content" class="space-y-10">

    <!-- Header -->
    <div>
        <h1 class="text-2xl font-bold text-gray-900">Brokerage Accounts</h1>
        <p class="text-gray-400 mt-1">Manage your brokerage accounts and holdings</p>
    </div>

    <!-- Accounts Table -->
    <div class="overflow-hidden rounded-2xl shadow border border-gray-200">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-400">
                <tr>
                    <th class="px-6 py-3 text-left text-sm font-bold text-gray-800">
                        Name
                    </th>
                    <th class="px-6 py-3 text-left text-sm font-bold text-gray-800">
                        Number
                    </th>
                    <th class="px-6 py-3 text-right text-sm font-bold text-gray-800">
                        Actions
                    </th>
                </tr>
            </thead>

            <tbody class="divide-y divide-gray-100">
                <tr th:each="a : ${accounts}" class="hover:bg-gray-300 bg-gray-400">
                    <td class="px-6 py-4 font-medium text-gray-900"
                        th:text="${a.name}">
                    </td>

                    <td class="px-6 py-4 text-gray-900"
                        th:text="${a.number}">
                    </td>

                    <td class="px-6 py-4">
                        <div class="flex justify-end gap-2">

                            <form th:action="@{/holdings/view/{id}(id=${a.id})}"
                                  method="get">
                                <button
                                    class="px-3 py-1.5 text-sm rounded-lg bg-blue-600 border border-gray-200 text-white hover:bg-blue-700">
                                    Holdings
                                </button>
                            </form>

							<form th:action="@{/accounts/cash/{id}(id=${a.id})}"
                                  method="get">
                                <button
                                    class="px-3 py-1.5 text-sm rounded-lg bg-blue-600 border border-gray-200 text-white hover:bg-blue-700">
                                    Cash
                                </button>
                            </form>

                            <form th:if="${a.active}"
                                  th:action="@{/accounts/deactivate/{id}(id=${a.id})}"
                                  method="post">
                                <button
                                    class="px-3 py-1.5 text-sm rounded-lg bg-red-600 text-white border border-gray-200 hover:bg-red-700">
                                    Deactivate
                                </button>
                            </form>

                            <form th:unless="${a.active}"
                                  th:action="@{/accounts/activate/{id}(id=${a.id})}"
                                  method="post">
                                <button
                                    class="px-3 py-1.5 text-sm rounded-lg bg-green-600 border border-gray-200 text-white hover:bg-green-700">
                                    Activate
                                </button>
                            </form>

                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Create Account -->
    <div class="max-w-lg">
        <h2 class="text-xl font-bold mb-4">Create Account</h2>

        <form th:action="@{/accounts}"
              th:object="${account}"
              method="post"
              class="shadow rounded-2xl p-6 space-y-4 border bg-gray-400">

            <div>
                <label class="block text-sm font-bold text-gray-800">
                    Name
                </label>
                <input th:field="*{name}"
                       class="mt-1 w-full rounded-lg border-gray-200 focus:ring-blue-500 focus:border-blue-500"/>
            </div>

            <div>
                <label class="block text-sm font-bold text-gray-800">
                    Number
                </label>
                <input th:field="*{number}"
                       class="mt-1 w-full rounded-lg border-gray-300 focus:ring-blue-500 focus:border-blue-500"/>
            </div>

            <div class="text-right">
                <button
                    class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 border border-gray-200">
                    Add Account
                </button>
            </div>
        </form>
    </div>

    <!-- Import Trades -->
    <div class="max-w-lg">
        <h2 class="text-xl font-bold mb-4">Import Trades</h2>

        <form th:action="@{/trades/import}"
              method="post"
              enctype="multipart/form-data"
              class="bg-gray-400 shadow rounded-2xl p-6 border space-y-4">

            <input type="file"
                   name="file"
                   accept=".csv"
                   required
                   class="block w-full text-sm text-gray-600"/>

            <button
                class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 border border-gray-200">
                Import CSV
            </button>
        </form>
    </div>

    <!-- Totals -->
    <div>
        <h2 class="text-xl font-bold mb-4">2026 Sold Totals</h2>

        <div class="flex flex-wrap gap-3">
            <form th:action="@{/trades/sold/2026}" method="get">
                <button class="px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-indigo-700 border border-gray-200">
                    View Sold Totals
                </button>
            </form>

            <form th:action="@{/trades/sold/2026/export/csv}" method="get">
                <button class="px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 border border-gray-200">
                    Download CSV
                </button>
            </form>

            <form th:action="@{/trades/sold/2026/export/excel}" method="get">
                <button class="px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-800 border border-gray-200">
                    Download Excel
                </button>
            </form>
        </div>
    </div>

</div>
</body>
</html>
